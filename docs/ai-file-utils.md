# AI File Utils

The `ai_file_utils` module serves as a centralized "contract" and utility service for defining and resolving actions related to AI artifacts. It allows you to separate the *definition* of actions (like "View Markdown", "Open in ChatGPT") from the *implementation* in the UI.

This is not a standalone MkDocs plugin but a shared library that other plugins (like `resolve_md`) can import to generate standardized action lists for any documentation page.

## ðŸ”¹ Usage

Since this is a helper library, you do not need to add it to your `mkdocs.yml` plugins list.

### Using in Python Code

Import the utility class directly in your code. The primary API is `resolve_actions`, which takes page context and returns a list of fully resolved action objects.

```python
from plugins.ai_file_utils.ai_file_utils import AIFileUtils

# Instantiate
utils = AIFileUtils()

# Resolve actions for a specific page context
actions = utils.resolve_actions(
    page_url="https://docs.example.com/ai/pages/my-page.md",
    filename="my-page.md",
    content="# My Page Content..."
)
```

### Schema Fields

| Field | Type | Description |
| :--- | :--- | :--- |
| `type` | `string` | The category of action. Currently supports `link` (navigation) and `clipboard` (copy text). |
| `id` | `string` | Unique identifier (e.g., `view-markdown`, `open-chat-gpt`). |
| `label` | `string` | The human-readable text displayed in the UI. |
| `analyticsKey` | `string` | A standardized key for tracking usage events. |
| `href` | `string` | (Link only) The destination URL. Supports interpolation. |
| `download` | `string` | (Link only) If present, triggers a file download with this filename. |
| `clipboardContent` | `string` | (Clipboard only) The text to be copied. |
| `promptTemplate` | `string` | (LLM only) A template used to generate the `{{ prompt }}` variable. |

### Interpolation Variables

The module supports dynamic injection of context using `{{ variable }}` syntax.

| Variable | Description |
| :--- | :--- |
| `{{ page_url }}` | The full URL to the resolved AI artifact (the markdown file). |
| `{{ filename }}` | The filename of the markdown file (e.g., `basics.md`). |
| `{{ content }}` | The full text content of the markdown file. |
| `{{ prompt }}` | A special variable generated by processing the `promptTemplate` and URL-encoding the result. |

## ðŸ”¹ Adding New Actions

To add a new action (e.g., "Open in Gemini"), you modify `plugins/ai_file_utils/ai_file_actions.json`. You do not need to write new Python code.

### Example: Adding a New LLM

```json
{
  "type": "link",
  "id": "open-gemini",
  "label": "Open in Gemini",
  "href": "https://gemini.google.com/app?q={{ prompt }}",
  "promptTemplate": "Read {{ page_url }} and explain it to me.",
  "analyticsKey": "open_page_markdown_gemini"
}
```

This configuration will automatically:
1.  Resolve `{{ page_url }}` in the prompt template.
2.  URL-encode the result into `{{ prompt }}`.
3.  Inject it into the `href`.
