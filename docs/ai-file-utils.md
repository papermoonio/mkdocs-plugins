# AI File Utils Plugin

The AI File Utils plugin serves as a centralized "contract" and utility service for defining and resolving actions related to AI artifacts. It allows you to separate the *definition* of actions (like "View Markdown", "Open in ChatGPT") from the *implementation* in the UI.

This plugin does not output files directly; instead, it provides a Python API that other plugins (like `resolve_md`) can essentially import and use to generate standardized action lists for any documentation page.

## ðŸ”¹ Usage

Enable the plugin in your `mkdocs.yml`. It requires no configuration options in the YAML itself, as it loads its schema from an internal JSON file.

```yaml
plugins:
  - ai_file_utils
```

### Using in Python Code

Other plugins can access the utilities provided by this plugin. The primary API is `resolve_actions`, which takes page context and returns a list of fully resolved action objects.

```python
from plugins.ai_file_utils.plugin import AIFileUtilsPlugin

# Instantiate (or get reference to)
utils = AIFileUtilsPlugin()
# Ensure config is loaded
utils.on_config({})

# Resolve actions for a specific page context
actions = utils.resolve_actions(
    page_url="https://docs.example.com/ai/pages/my-page.md",
    filename="my-page.md",
    content="# My Page Content..."
)
```

## ðŸ”¹ The Action Model

The core of this plugin is the **Action Model**, defined in `ai_file_actions.json`. This JSON schema defines what actions are available and how they behave.

### Schema Fields

| Field | Type | Description |
| :--- | :--- | :--- |
| `type` | `string` | The category of action. Currently supports `link` (navigation) and `clipboard` (copy text). |
| `id` | `string` | Unique identifier (e.g., `view-markdown`, `open-chat-gpt`). |
| `label` | `string` | The human-readable text displayed in the UI. |
| `analyticsKey` | `string` | A standardized key for tracking usage events. |
| `href` | `string` | (Link only) The destination URL. Supports interpolation. |
| `download` | `string` | (Link only) If present, triggers a file download with this filename. |
| `clipboardContent` | `string` | (Clipboard only) The text to be copied. |
| `promptTemplate` | `string` | (LLM only) A template used to generate the `{{ prompt }}` variable. |

### Interpolation Variables

The plugin supports dynamic injection of context using `{{ variable }}` syntax.

| Variable | Description |
| :--- | :--- |
| `{{ page_url }}` | The full URL to the resolved AI artifact (the markdown file). |
| `{{ filename }}` | The filename of the markdown file (e.g., `basics.md`). |
| `{{ content }}` | The full text content of the markdown file. |
| `{{ prompt }}` | A special variable generated by processing the `promptTemplate` and URL-encoding the result. |

## ðŸ”¹ Adding New Actions

To add a new action (e.g., "Open in Gemini"), you modify `plugins/ai_file_utils/ai_file_actions.json`. You do not need to write new Python code.

### Example: Adding a new LLM

```json
{
  "type": "link",
  "id": "open-gemini",
  "label": "Open in Gemini",
  "href": "https://gemini.google.com/app?q={{ prompt }}",
  "promptTemplate": "Read {{ page_url }} and explain it to me.",
  "analyticsKey": "open_page_markdown_gemini"
}
```

This configuration will automatically:
1.  Resolve `{{ page_url }}` in the prompt template.
2.  URL-encode the result into `{{ prompt }}`.
3.  Inject it into the `href`.
